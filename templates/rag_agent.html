{% extends "base.html" %}

{% block title %}RAG Agent{% endblock %}

{% block content %}
    <h4>RAG Agent</h4>

    <!-- Message Section -->
    {% if message %}
    <div class="alert alert-info alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}

    <!-- Form for user input -->
    <form method="POST">
        <div class="form-group">
            <label for="objective">Objective</label>
            <textarea class="form-control" id="objective" name="objective" rows="10" placeholder="Insert an objective for the agent to process..."></textarea>
        </div>
        <button type="submit" class="btn btn-success mt-3">Submit</button>
        <button type="submit" class="btn btn-primary mt-3" name="load_files">Load Documents</button>
    </form>

    <!-- Divider -->
    <hr class="my-3" />

    <!-- Display Final Answer -->
    {% if final_answer %}
    <h5 class="mt-4">Final Answer:</h5>
    <div class="card bg-light">
        <div class="card-body">
            <pre class="pre-wrap">{{ final_answer|safe }}</pre>
        </div>
    </div>
    {% endif %}

    <!-- Display Reasoning Steps -->
    {% if reasoning_steps %}
    <h5 class="mt-4">Reasoning Steps:</h5>
    <ul class="list-group">
        {% for step in reasoning_steps %}
        <li class="list-group-item"><pre class="pre-wrap">{{ step|safe }}</pre></li>
        {% endfor %}
    </ul>
    {% endif %}

    <!-- Display Sources -->
    {% if snippets %}
    <h5 class="mt-4">Sources Used:</h5>
    <ul class="list-group">
        {% for snippet in snippets %}
        <li class="list-group-item"><pre class="pre-wrap">{{ snippet|safe }}</pre></li>
        {% endfor %}
    </ul>
    {% endif %}

{% endblock %}